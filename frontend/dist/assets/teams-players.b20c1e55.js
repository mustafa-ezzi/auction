import{aU as b,aW as p,ba as x,r as w,o as i,ah as n,ab as r,e,b as l,a8 as f,af as I,ad as U,ai as y,aj as E,ak as m,aY as g,f as h,R as d,i as u,a9 as _,b5 as V,T as v,aa as P,a$ as k,b1 as S,ac as B,ag as M,ae as j}from"./index.1658c72d.js";import{L as A,V as C}from"./VSnackbar.726a4d99.js";import{V as L}from"./VTable.710b72e3.js";const N={components:{LoadingOverlay:A},data(){return{projectId:null,editSoldDialog:!1,players:[],deleteId:null,teams:[],editSoldDialog:!1,soldPrice:null,currentPlayerId:null,selectedTeam:null,deleteDialog:!1,snack:!1,Soldsnack:!1,overlay:!1,errorMessage:""}},watch:{selectedTeam:function(){this.getPlayersByTeam()}},mounted(){this.projectId=localStorage.getItem("projectId"),this.getAllTeams()},methods:{async getPlayersByTeam(){this.overlay=!0;try{const s=await p(`/players/team/${this.selectedTeam}/`);this.players=s.data.data,this.overlay=!1}catch(s){console.error("Error fetching product options:",s),this.overlay=!1}},async reversePlayer(){try{const s=await p(`/auction/reverse-player/${this.deleteId}/`);this.snack=!0,this.deleteDialog=!1,this.getPlayersByTeam()}catch(s){console.error("Error fetching product options:",s)}},async getAllTeams(){this.overlay=!0;try{const s=await p(`/all/teams/${this.projectId}/`);this.teams=s.data.data,this.overlay=!1,this.teams.length>0&&(this.selectedTeam=this.teams[0].id)}catch(s){console.error("Error fetching product options:",s)}},openEditSoldDialog(s){this.soldPrice=s.sold_price,this.currentPlayerId=s.id,this.editSoldDialog=!0},async UpdateSoldPrice(){try{const s={sold_price:this.soldPrice};await x(`/auction/update/sold_price/${this.currentPlayerId}/`,s),this.editSoldDialog=!1,this.snack=!0,this.getPlayersByTeam()}catch(s){console.error("Error updating sold price:",s),s.response&&s.response.data&&s.response.data.message?this.errorMessage=s.response.data.message:this.errorMessage="An unexpected error occurred."}}}},R={style:{"background-color":"white","border-radius":"30px"}},F=r("h1",{class:"ml-5 mt-2 heading"}," Player - Team ",-1),O=r("thead",null,[r("tr",null,[r("th",null," Name "),r("th",null," Profile Picture "),r("th",null," Sold Price "),r("th",null,"Category"),r("th")])],-1),Y=["src"],q={class:"sold-price-wrapper"},z={key:0,class:"error-text"};function W(s,o,G,H,t,c){const D=w("LoadingOverlay");return i(),n(y,null,[r("div",R,[e(U,null,{default:l(()=>[e(f,{md:"9",sm:"12"},{default:l(()=>[F]),_:1}),e(f,{md:"3",sm:"12",class:"mb-3"},{default:l(()=>[e(I,{class:"mr-4",modelValue:t.selectedTeam,"onUpdate:modelValue":o[0]||(o[0]=a=>t.selectedTeam=a),label:"Teams",items:t.teams,"item-value":"id","item-title":"name"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(L,{style:{"border-radius":"30px"}},{default:l(()=>[O,r("tbody",null,[(i(!0),n(y,null,E(t.players,a=>(i(),n("tr",{key:a.name},[r("td",null,m(a.name),1),r("td",null,[a.profile_pic?(i(),n("img",{key:0,class:"image mt-1 mb-1",src:a.profile_pic},null,8,Y)):g("",!0)]),r("td",null,[r("div",q,[r("span",null,m(a.sold_price),1),e(h,{style:{"margin-left":"18px"},onClick:T=>c.openEditSoldDialog(a)},{default:l(()=>[d("mdi-pencil")]),_:2},1032,["onClick"])])]),r("td",null,m(a.category_name),1),r("td",null,[e(u,{class:"mr-2",color:"primary",size:"small",onClick:T=>{t.deleteDialog=!0,t.deleteId=a.id}},{default:l(()=>[e(h,null,{default:l(()=>[d("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])]))),128))])]),_:1})]),e(S,{modelValue:t.deleteDialog,"onUpdate:modelValue":o[2]||(o[2]=a=>t.deleteDialog=a),"max-width":"400",persistent:"",width:"500"},{default:l(()=>[e(_,null,{default:l(()=>[e(V,{class:"headline red--text"},{default:l(()=>[d(" Confirm Reverse ")]),_:1}),e(v),e(P,null,{default:l(()=>[d(" Are you sure you want to remove this Player? ")]),_:1}),e(k,null,{default:l(()=>[e(f,{cols:"12"},{default:l(()=>[e(u,{class:"mr-2",color:"error",dark:"",onClick:c.reversePlayer},{default:l(()=>[d(" Remove ")]),_:1},8,["onClick"]),e(u,{color:"secondary",onClick:o[1]||(o[1]=a=>t.deleteDialog=!1)},{default:l(()=>[d(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:t.snack,"onUpdate:modelValue":o[3]||(o[3]=a=>t.snack=a)},{default:l(()=>[d(" Your player reversed Successfully ")]),_:1},8,["modelValue"]),e(C,{modelValue:t.Soldsnack,"onUpdate:modelValue":o[4]||(o[4]=a=>t.Soldsnack=a)},{default:l(()=>[d(" Player's sold price UPDATED! ")]),_:1},8,["modelValue"]),e(D,{isVisible:t.overlay},null,8,["isVisible"]),e(S,{modelValue:t.editSoldDialog,"onUpdate:modelValue":o[7]||(o[7]=a=>t.editSoldDialog=a),persistent:"","max-width":"400"},{default:l(()=>[e(_,null,{default:l(()=>[e(V,{class:"headline text-center"},{default:l(()=>[d("Edit Sold Price")]),_:1}),e(v),e(P,null,{default:l(()=>[e(B,{onSubmit:M(c.UpdateSoldPrice,["prevent"])},{default:l(()=>[e(j,{modelValue:t.soldPrice,"onUpdate:modelValue":o[5]||(o[5]=a=>t.soldPrice=a),label:"Sold Price",type:"number",required:""},null,8,["modelValue"])]),_:1},8,["onSubmit"]),t.errorMessage?(i(),n("p",z,m(t.errorMessage),1)):g("",!0)]),_:1}),e(k,{class:"justify-center"},{default:l(()=>[e(u,{color:"grey",onClick:o[6]||(o[6]=a=>(t.editSoldDialog=!1,this.errorMessage=""))},{default:l(()=>[d("Cancel")]),_:1}),e(u,{color:"green",onClick:c.UpdateSoldPrice},{default:l(()=>[d("Save")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const X=b(N,[["render",W]]);export{X as default};
